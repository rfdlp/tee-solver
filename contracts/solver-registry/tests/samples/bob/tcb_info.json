{
   "rootfs_hash": "355eabbaf84843b85bdfba348baf46dc0f3c4e02326f0b23ff124e36bb053327c2f78d745391b5e9da692472be851d74",
   "mrtd": "c68518a0ebb42136c12b2275164f8c72f25fa9a34392228687ed6e9caeb9c0f1dbd895e9cf475121c029dc47e70e91fd",
   "rtmr0": "85e0855a6384fa1c8a6ab36d0dcbfaa11a5753e5a070c08218ae5fe872fcb86967fd2449c29e22e59dc9fec998cb6547",
   "rtmr1": "154e08f5c1f7b1fce4cbfe1c14f3ba67b70044ede2751487279cd1f2e4239dee99a6d45e24ebde6b6a6f5ae49878e0e6",
   "rtmr2": "9edcd363660e85b71c318324996dda756c372d9f6960edbfa863b1e684822eb48dd95e218ae2b78e51ef97f3b8f5c9dc",
   "rtmr3": "4ac3c9279570e72ed82275275b3daa645868d24251fd357e6bf6a26a59d864797f42e77bdf034b8ce80e5c5c06c81071",
   "event_log": [
     {
       "imr": 0,
       "event_type": 2147483659,
       "digest": "0e35f1b315ba6c912cf791e5c79dd9d3a2b8704516aa27d4e5aa78fb09ede04aef2bbd02ac7a8734c48562b9c26ba35d",
       "event": "",
       "event_payload": "095464785461626c65000100000000000000af96bb93f2b9b84e9462e0ba745642360090800000000000"
     },
     {
       "imr": 0,
       "event_type": 2147483658,
       "digest": "344bc51c980ba621aaa00da3ed7436f7d6e549197dfe699515dfa2c6583d95e6412af21c097d473155875ffd561d6790",
       "event": "",
       "event_payload": "2946762858585858585858582d585858582d585858582d585858582d58585858585858585858585829000000c0ff000000000040080000000000"
     },
     {
       "imr": 0,
       "event_type": 2147483649,
       "digest": "9dc3a1f80bcec915391dcda5ffbb15e7419f77eab462bbf72b42166fb70d50325e37b36f93537a863769bcf9bedae6fb",
       "event": "",
       "event_payload": "61dfe48bca93d211aa0d00e098032b8c0a00000000000000000000000000000053006500630075007200650042006f006f007400"
     },
     {
       "imr": 0,
       "event_type": 2147483649,
       "digest": "6f2e3cbc14f9def86980f5f66fd85e99d63e69a73014ed8a5633ce56eca5b64b692108c56110e22acadcef58c3250f1b",
       "event": "",
       "event_payload": "61dfe48bca93d211aa0d00e098032b8c0200000000000000000000000000000050004b00"
     },
     {
       "imr": 0,
       "event_type": 2147483649,
       "digest": "d607c0efb41c0d757d69bca0615c3a9ac0b1db06c557d992e906c6b7dee40e0e031640c7bfd7bcd35844ef9edeadc6f9",
       "event": "",
       "event_payload": "61dfe48bca93d211aa0d00e098032b8c030000000000000000000000000000004b0045004b00"
     },
     {
       "imr": 0,
       "event_type": 2147483649,
       "digest": "08a74f8963b337acb6c93682f934496373679dd26af1089cb4eaf0c30cf260a12e814856385ab8843e56a9acea19e127",
       "event": "",
       "event_payload": "cbb219d73a3d9645a3bcdad00e67656f0200000000000000000000000000000064006200"
     },
     {
       "imr": 0,
       "event_type": 2147483649,
       "digest": "18cc6e01f0c6ea99aa23f8a280423e94ad81d96d0aeb5180504fc0f7a40cb3619dd39bd6a95ec1680a86ed6ab0f9828d",
       "event": "",
       "event_payload": "cbb219d73a3d9645a3bcdad00e67656f03000000000000000000000000000000640062007800"
     },
     {
       "imr": 0,
       "event_type": 4,
       "digest": "394341b7182cd227c5c6b07ef8000cdfd86136c4292b8e576573ad7ed9ae41019f5818b4b971c9effc60e1ad9f1289f0",
       "event": "",
       "event_payload": "00000000"
     },
     {
       "imr": 0,
       "event_type": 10,
       "digest": "68cd79315e70aecd4afe7c1b23a5ed7b3b8e51a477e1739f111b3156def86bbc56ebf239dcd4591bc7a9fff90023f481",
       "event": "",
       "event_payload": "414350492044415441"
     },
     {
       "imr": 0,
       "event_type": 10,
       "digest": "6bc203b3843388cc4918459c3f5c6d1300a796fb594781b7ecfaa3ae7456975f095bfcc1156c9f2d25e8b8bc1b520f66",
       "event": "",
       "event_payload": "414350492044415441"
     },
     {
       "imr": 0,
       "event_type": 10,
       "digest": "ec9e8622a100c399d71062a945f95d8e4cdb7294e8b1c6d17a6a8d37b5084444000a78b007ef533f290243421256d25c",
       "event": "",
       "event_payload": "414350492044415441"
     },
     {
       "imr": 1,
       "event_type": 2147483651,
       "digest": "b8420535898e24a6abef877153ac1103a695ed07ab9c6c74182d865a560b3b587a34d4bfdc671a505def683cc7bc7596",
       "event": "",
       "event_payload": "1860437b0000000000f4b3000000000000000000000000002a000000000000000403140072f728144ab61e44b8c39ebdd7f893c7040412006b00650072006e0065006c0000007fff0400"
     },
     {
       "imr": 0,
       "event_type": 2147483650,
       "digest": "1dd6f7b457ad880d840d41c961283bab688e94e4b59359ea45686581e90feccea3c624b1226113f824f315eb60ae0a7c",
       "event": "",
       "event_payload": "61dfe48bca93d211aa0d00e098032b8c0900000000000000020000000000000042006f006f0074004f0072006400650072000000"
     },
     {
       "imr": 0,
       "event_type": 2147483650,
       "digest": "23ada07f5261f12f34a0bd8e46760962d6b4d576a416f1fea1c64bc656b1d28eacf7047ae6e967c58fd2a98bfa74c298",
       "event": "",
       "event_payload": "61dfe48bca93d211aa0d00e098032b8c08000000000000003e0000000000000042006f006f0074003000300030003000090100002c0055006900410070007000000004071400c9bdb87cebf8344faaea3ee4af6516a10406140021aa2c4614760345836e8ab6f46623317fff0400"
     },
     {
       "imr": 1,
       "event_type": 2147483655,
       "digest": "77a0dab2312b4e1e57a84d865a21e5b2ee8d677a21012ada819d0a98988078d3d740f6346bfe0abaa938ca20439a8d71",
       "event": "",
       "event_payload": "43616c6c696e6720454649204170706c69636174696f6e2066726f6d20426f6f74204f7074696f6e"
     },
     {
       "imr": 1,
       "event_type": 4,
       "digest": "394341b7182cd227c5c6b07ef8000cdfd86136c4292b8e576573ad7ed9ae41019f5818b4b971c9effc60e1ad9f1289f0",
       "event": "",
       "event_payload": "00000000"
     },
     {
       "imr": 2,
       "event_type": 6,
       "digest": "a68ac6d65dd62f392826c2ae44f6846363ced3418c96574b3e168de9205c8553b8198c3b9d206bc432d70a923c25b098",
       "event": "",
       "event_payload": "ed223b8f1a0000004c4f414445445f494d4147453a3a4c6f61644f7074696f6e7300"
     },
     {
       "imr": 2,
       "event_type": 6,
       "digest": "41ee4a6d142b51085c720bad4170207359538d9785391ce10b17536153ea5ba49edaa5a8c36f9f081fdf1b7aeb0ce3f0",
       "event": "",
       "event_payload": "ec223b8f0d0000004c696e757820696e6974726400"
     },
     {
       "imr": 1,
       "event_type": 2147483655,
       "digest": "214b0bef1379756011344877743fdc2a5382bac6e70362d624ccf3f654407c1b4badf7d8f9295dd3dabdef65b27677e0",
       "event": "",
       "event_payload": "4578697420426f6f7420536572766963657320496e766f636174696f6e"
     },
     {
       "imr": 1,
       "event_type": 2147483655,
       "digest": "0a2e01c85deae718a530ad8c6d20a84009babe6c8989269e950d8cf440c6e997695e64d455c4174a652cd080f6230b74",
       "event": "",
       "event_payload": "4578697420426f6f742053657276696365732052657475726e656420776974682053756363657373"
     },
     {
       "imr": 3,
       "event_type": 134217729,
       "digest": "355eabbaf84843b85bdfba348baf46dc0f3c4e02326f0b23ff124e36bb053327c2f78d745391b5e9da692472be851d74",
       "event": "rootfs-hash",
       "event_payload": "8b32065c2f0e77328fafc18f784b3f0bb02239e4a0dc2e2ebc1918e6a54b9cce"
     },
     {
       "imr": 3,
       "event_type": 134217729,
       "digest": "9e32d7c700b42f81a06ff6fa619189225000bdd5bb1a7b993572f4ef693ac63495aace277189b3e2524904ae119c4f2e",
       "event": "app-id",
       "event_payload": "428b8d8e30296936572684a09c81ffb7709102e3"
     },
     {
       "imr": 3,
       "event_type": 134217729,
       "digest": "b518590d11b84e8109866756a6cd438d707366a330ebc6e83e6fe293dd14d8c562b57dde56b259871fa65ca2bb97d593",
       "event": "compose-hash",
       "event_payload": "e539ba88bb6f4270414cb5180bfda1962759e923e3a09c07b7bf51b60d1263df"
     },
     {
       "imr": 3,
       "event_type": 134217729,
       "digest": "5b6a576d1da40f04179ad469e00f90a1c0044bc9e8472d0da2776acb108dc98a73560d42cea6b8b763eb4a0e6d4d82d5",
       "event": "ca-cert-hash",
       "event_payload": "d2d9c7c29e3f18e69cba87438cef21eea084c2110858230cd39c5decc629a958"
     },
     {
       "imr": 3,
       "event_type": 134217729,
       "digest": "a4aefe9aa3924953698d210a2550538c191005c767d65a5f0ef78304d88700cf9bce558f62c979e8480cf303629deb26",
       "event": "instance-id",
       "event_payload": "5b7fd2d2df7276baaffe2dff54ee779792209195"
     }
   ],
   "app_compose": "{\n    \"allowed_envs\":[],\n    \"default_gateway_domain\":\"dstack-prod8.phala.network\",\n    \"docker_compose_file\":\"version: '3.8'\\n\\nservices:\\n  intents_tee_amm_solver:\\n    image: robortyan/intents-tee-amm-solver:latest@sha256:69f1a94f8c2725523087083139f925aae588ffaa76efd08d7ba06529451c31ed\\n    platform: linux/amd64\\n    ports:\\n      - \\\"3000:3000\\\"\\n    environment:\\n      NEAR_NETWORK_ID: ${NEAR_NETWORK_ID}\\n      NEAR_NODE_URL: ${NEAR_NODE_URL}\\n      INTENTS_CONTRACT: ${INTENTS_CONTRACT}\\n      SOLVER_REGISTRY_CONTRACT: ${SOLVER_REGISTRY_CONTRACT}\\n      SOLVER_POOL_ID: ${SOLVER_POOL_ID}\\n      AMM_TOKEN1_ID: ${AMM_TOKEN1_ID}\\n      AMM_TOKEN2_ID: ${AMM_TOKEN2_ID}\\n    restart: unless-stopped\\n    volumes:\\n      - /var/run/tappd.sock:/var/run/tappd.sock\\n\",\n    \"features\":[\n        \"kms\",\n        \"tproxy-net\"\n    ],\n    \"gateway_enabled\":true,\n    \"kms_enabled\":true,\n    \"local_key_provider_enabled\":false,\n    \"manifest_version\":2,\n    \"name\":\"intents-solver-1\",\n    \"no_instance_id\":false,\n    \"pre_launch_script\":\"\\n#!/bin/bash\\necho \\\"----------------------------------------------\\\"\\necho \\\"Running Phala Cloud Pre-Launch Script v0.0.7\\\"\\necho \\\"----------------------------------------------\\\"\\nset -e\\n\\n# Function: notify host\\n\\nnotify_host() {\\n    if command -v dstack-util >/dev/null 2>&1; then\\n        dstack-util notify-host -e \\\"$1\\\" -d \\\"$2\\\"\\n    else\\n        tdxctl notify-host -e \\\"$1\\\" -d \\\"$2\\\"\\n    fi\\n}\\n\\nnotify_host_hoot_info() {\\n    notify_host \\\"boot.progress\\\" \\\"$1\\\"\\n}\\n\\nnotify_host_hoot_error() {\\n    notify_host \\\"boot.error\\\" \\\"$1\\\"\\n}\\n\\n# Function: Perform Docker cleanup\\nperform_cleanup() {\\n    echo \\\"Pruning unused images\\\"\\n    docker image prune -af\\n    echo \\\"Pruning unused volumes\\\"\\n    docker volume prune -f\\n    notify_host_hoot_info \\\"docker cleanup completed\\\"\\n}\\n\\n# Function: Check Docker login status without exposing credentials\\ncheck_docker_login() {\\n    # Try to verify login status without exposing credentials\\n    if docker info 2>/dev/null | grep -q \\\"Username\\\"; then\\n        return 0\\n    else\\n        return 1\\n    fi\\n}\\n\\n# Main logic starts here\\necho \\\"Starting login process...\\\"\\n\\n# Check if Docker credentials exist\\nif [[ -n \\\"$DSTACK_DOCKER_USERNAME\\\" && -n \\\"$DSTACK_DOCKER_PASSWORD\\\" ]]; then\\n    echo \\\"Docker credentials found\\\"\\n    \\n    # Check if already logged in\\n    if check_docker_login; then\\n        echo \\\"Already logged in to Docker registry\\\"\\n    else\\n        echo \\\"Logging in to Docker registry...\\\"\\n        # Login without exposing password in process list\\n        if [[ -n \\\"$DSTACK_DOCKER_REGISTRY\\\" ]]; then\\n            echo \\\"$DSTACK_DOCKER_PASSWORD\\\" | docker login -u \\\"$DSTACK_DOCKER_USERNAME\\\" --password-stdin \\\"$DSTACK_DOCKER_REGISTRY\\\"\\n        else\\n            echo \\\"$DSTACK_DOCKER_PASSWORD\\\" | docker login -u \\\"$DSTACK_DOCKER_USERNAME\\\" --password-stdin\\n        fi\\n        \\n        if [ $? -eq 0 ]; then\\n            echo \\\"Docker login successful\\\"\\n        else\\n            echo \\\"Docker login failed\\\"\\n            notify_host_hoot_error \\\"docker login failed\\\"\\n            exit 1\\n        fi\\n    fi\\n# Check if AWS ECR credentials exist\\nelif [[ -n \\\"$DSTACK_AWS_ACCESS_KEY_ID\\\" && -n \\\"$DSTACK_AWS_SECRET_ACCESS_KEY\\\" && -n \\\"$DSTACK_AWS_REGION\\\" && -n \\\"$DSTACK_AWS_ECR_REGISTRY\\\" ]]; then\\n    echo \\\"AWS ECR credentials found\\\"\\n    \\n    # Check if AWS CLI is installed\\n    if ! command -v aws &> /dev/null; then\\n        notify_host_hoot_info \\\"awscli not installed, installing...\\\"\\n        echo \\\"AWS CLI not installed, installing...\\\"\\n        curl \\\"https://awscli.amazonaws.com/awscli-exe-linux-x86_64-2.24.14.zip\\\" -o \\\"awscliv2.zip\\\"\\n        echo \\\"6ff031a26df7daebbfa3ccddc9af1450 awscliv2.zip\\\" | md5sum -c\\n        if [ $? -ne 0 ]; then\\n            echo \\\"MD5 checksum failed\\\"\\n            notify_host_hoot_error \\\"awscli install failed\\\"\\n            exit 1\\n        fi\\n        unzip awscliv2.zip &> /dev/null\\n        ./aws/install\\n        \\n        # Clean up installation files\\n        rm -rf awscliv2.zip aws\\n    else\\n        echo \\\"AWS CLI is already installed: $(which aws)\\\"\\n    fi\\n\\n    # Set AWS credentials as environment variables\\n    export AWS_ACCESS_KEY_ID=\\\"$DSTACK_AWS_ACCESS_KEY_ID\\\"\\n    export AWS_SECRET_ACCESS_KEY=\\\"$DSTACK_AWS_SECRET_ACCESS_KEY\\\"\\n    export AWS_DEFAULT_REGION=\\\"$DSTACK_AWS_REGION\\\"\\n    \\n    # Set session token if provided (for temporary credentials)\\n    if [[ -n \\\"$DSTACK_AWS_SESSION_TOKEN\\\" ]]; then\\n        echo \\\"AWS session token found, using temporary credentials\\\"\\n        export AWS_SESSION_TOKEN=\\\"$DSTACK_AWS_SESSION_TOKEN\\\"\\n    fi\\n    \\n    # Test AWS credentials before attempting ECR login\\n    echo \\\"Testing AWS credentials...\\\"\\n    if ! aws sts get-caller-identity &> /dev/null; then\\n        echo \\\"AWS credentials test failed\\\"\\n        notify_host_hoot_error \\\"Invalid AWS credentials\\\"\\n        exit 1\\n    fi\\n\\n    echo \\\"Logging in to AWS ECR...\\\"\\n    aws ecr get-login-password --region $DSTACK_AWS_REGION | docker login --username AWS --password-stdin \\\"$DSTACK_AWS_ECR_REGISTRY\\\"\\n    if [ $? -eq 0 ]; then\\n        echo \\\"AWS ECR login successful\\\"\\n        notify_host_hoot_info \\\"AWS ECR login successful\\\"\\n    else\\n        echo \\\"AWS ECR login failed\\\"\\n        notify_host_hoot_error \\\"AWS ECR login failed\\\"\\n        exit 1\\n    fi\\nfi\\n\\nperform_cleanup\\n\\n#\\n# Set root password if DSTACK_ROOT_PASSWORD is set.\\n#\\nif [[ -n \\\"$DSTACK_ROOT_PASSWORD\\\" ]]; then\\n    echo \\\"root:$DSTACK_ROOT_PASSWORD\\\" | chpasswd\\n    unset $DSTACK_ROOT_PASSWORD\\n    echo \\\"Root password set\\\"\\nfi\\nif [[ -n \\\"$DSTACK_ROOT_PUBLIC_KEY\\\" ]]; then\\n    mkdir -p /root/.ssh\\n    echo \\\"$DSTACK_ROOT_PUBLIC_KEY\\\" > /root/.ssh/authorized_keys\\n    unset $DSTACK_ROOT_PUBLIC_KEY\\n    echo \\\"Root public key set\\\"\\nfi\\n\\n\\nif [[ -e /var/run/dstack.sock ]]; then\\n    export DSTACK_APP_ID=$(curl -s --unix-socket /var/run/dstack.sock http://dstack/Info | jq -j .app_id)\\nelse\\n    export DSTACK_APP_ID=$(curl -s --unix-socket /var/run/tappd.sock http://dstack/prpc/Tappd.Info | jq -j .app_id)\\nfi\\n# Check if app-compose.json has default_gateway_domain field and DSTACK_GATEWAY_DOMAIN is not set\\n# If true, set DSTACK_GATEWAY_DOMAIN from app-compose.json\\nif [[ $(jq 'has(\\\"default_gateway_domain\\\")' app-compose.json) == \\\"true\\\" && -z \\\"$DSTACK_GATEWAY_DOMAIN\\\" ]]; then\\n    export DSTACK_GATEWAY_DOMAIN=$(jq -j '.default_gateway_domain' app-compose.json)\\nfi\\nif [[ -n \\\"$DSTACK_GATEWAY_DOMAIN\\\" ]]; then\\n    export DSTACK_APP_DOMAIN=$DSTACK_APP_ID\\\".\\\"$DSTACK_GATEWAY_DOMAIN\\nfi\\n\\necho \\\"----------------------------------------------\\\"\\necho \\\"Script execution completed\\\"\\necho \\\"----------------------------------------------\\\"\\n\",\n    \"public_logs\":true,\n    \"public_sysinfo\":true,\n    \"runner\":\"docker-compose\",\n    \"tproxy_enabled\":true\n}"
}